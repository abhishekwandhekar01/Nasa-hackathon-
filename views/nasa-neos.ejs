<%- include('partials/header') %>

<div class="container mt-4">
  <h2>Near Earth Objects Today</h2>
  <% if (!neos || neos.length === 0) { %>
    <p>No NEOs data available for today.</p>
  <% } else { %>
    <div class="row neo-grid">
    <% neos.forEach(function(neo) { 
      // compute a visual size for the svg thumbnail based on diameter (clamped)
      const dMin = neo.estimated_diameter.meters.estimated_diameter_min;
      const dMax = neo.estimated_diameter.meters.estimated_diameter_max;
      const avg = (dMin + dMax) / 2;
      const size = Math.min(120, Math.max(48, Math.round(avg)));
      let sizeClass = 'medium';
      if (size <= 64) sizeClass = 'small';
      else if (size >= 96) sizeClass = 'large';
      else sizeClass = 'medium';
    %>
        <div class="col-sm-6 col-md-4 col-lg-3 mb-3">
          <div class="card neo-card p-3">
            <div class="d-flex gap-3">
              <div class="neo-thumb <%= sizeClass %>">
                <!-- simple asteroid-like SVG, fill changes if hazardous -->
                <svg viewBox="0 0 100 100" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <radialGradient id="g<%= neo.id %>"> <stop offset="0%" stop-color="#ffffff22"/> <stop offset="100%" stop-color="#ffffff00"/> </radialGradient>
                  </defs>
                  <circle cx="50" cy="50" r="48" fill="<%= neo.is_potentially_hazardous_asteroid ? '#ff8a8a' : '#d1eaff' %>" stroke="#ffffff22" stroke-width="2" />
                  <g fill="#ffffff88">
                    <circle cx="30" cy="35" r="6" />
                    <circle cx="60" cy="50" r="4" />
                    <circle cx="45" cy="70" r="3" />
                  </g>
                </svg>
              </div>
              <div class="flex-grow-1">
                <h5 class="neo-name"><%= neo.name %></h5>
                <p class="neo-diameter">~<%= avg.toFixed(1) %> m</p>
                <p class="neo-hazard"><strong>Hazard:</strong> <%= neo.is_potentially_hazardous_asteroid ? 'Potentially hazardous' : 'No' %></p>
                <div class="neo-actions">
                  <a class="btn btn-sm" href="https://ssd.jpl.nasa.gov/tools/sbdb_lookup.html#/?sstr=<%= encodeURIComponent(neo.name) %>" target="_blank">More info</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <% }) %>
    </div>
  <% } %>
</div>

<%- include('partials/footer') %>